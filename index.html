<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚µãƒ³ãƒªã‚ªã‚¯ãƒ¬ãƒ¼ãƒ—ï¼†ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­ã‚·ãƒ§ãƒƒãƒ—</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap');
        
        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            min-height: 100vh;
        }

        .character-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .character-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .character-active {
            border: 3px solid #ff69b4;
            box-shadow: 0 0 20px rgba(255,105,180,0.5);
        }

        .menu-item {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .menu-item:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .cooking-animation {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            text-align: center;
            min-width: 300px;
        }

        .cooking-step {
            font-size: 3rem;
            margin: 1rem 0;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .spin {
            animation: spin 2s linear infinite;
        }

        .voice-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 999;
        }

        .voice-active {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .cart-icon {
            position: fixed;
            top: 20px;
            right: 80px;
            z-index: 999;
        }

        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1001;
            padding: 1rem 2rem;
            background: #4CAF50;
            color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-pink-600 mb-2">ğŸ€ ã‚µãƒ³ãƒªã‚ªã‚¯ãƒ¬ãƒ¼ãƒ—ï¼†ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­ã‚·ãƒ§ãƒƒãƒ— ğŸ¥</h1>
            <p class="text-lg text-gray-700">5äººã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒãŠä½œã‚Šã—ã¾ã™â™ª</p>
        </div>

        <!-- Voice Controls -->
        <div class="voice-indicator">
            <button id="voiceBtn" class="bg-red-500 hover:bg-red-600 text-white p-3 rounded-full shadow-lg">
                <i class="fas fa-microphone text-xl"></i>
            </button>
        </div>

        <!-- Cart Icon -->
        <div class="cart-icon">
            <button id="cartBtn" class="bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full shadow-lg relative">
                <i class="fas fa-shopping-cart text-xl"></i>
                <span id="cartCount" class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 text-sm flex items-center justify-center">0</span>
            </button>
        </div>

        <!-- Characters -->
        <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-8">
            <div class="character-card bg-white rounded-lg p-4 shadow-lg text-center" data-character="kitty">
                <img src="https://www.sanrio.co.jp/wp-content/uploads/2022/06/list-hellokitty.png" alt="ãƒãƒ­ãƒ¼ã‚­ãƒ†ã‚£" class="w-20 h-20 mx-auto mb-2 rounded-full object-cover">
                <h3 class="font-bold text-pink-500">ã‚­ãƒ†ã‚£</h3>
            </div>
            <div class="character-card bg-white rounded-lg p-4 shadow-lg text-center" data-character="kuromi">
                <img src="https://www.sanrio.co.jp/wp-content/uploads/2022/06/list-kuromi.png" alt="ã‚¯ãƒ­ãƒŸ" class="w-20 h-20 mx-auto mb-2 rounded-full object-cover">
                <h3 class="font-bold text-purple-500">ã‚¯ãƒ­ãƒŸ</h3>
            </div>
            <div class="character-card bg-white rounded-lg p-4 shadow-lg text-center" data-character="pochacco">
                <img src="https://www.sanrio.co.jp/wp-content/uploads/2022/06/list-pochacco.png" alt="ãƒãƒãƒ£ãƒƒã‚³" class="w-20 h-20 mx-auto mb-2 rounded-full object-cover">
                <h3 class="font-bold text-blue-500">ãƒãƒãƒ£ãƒƒã‚³</h3>
            </div>
            <div class="character-card bg-white rounded-lg p-4 shadow-lg text-center" data-character="cinnamoroll">
                <img src="https://www.sanrio.co.jp/wp-content/uploads/2022/06/mv-cinnamon.png" alt="ã‚·ãƒŠãƒ¢ãƒ³" class="w-20 h-20 mx-auto mb-2 rounded-full object-cover">
                <h3 class="font-bold text-blue-300">ã‚·ãƒŠãƒ¢ãƒ³</h3>
            </div>
            <div class="character-card bg-white rounded-lg p-4 shadow-lg text-center" data-character="mymelody">
                <img src="https://www.sanrio.co.jp/wp-content/uploads/2022/06/list-mymelody.png" alt="ãƒã‚¤ãƒ¡ãƒ­ãƒ‡ã‚£" class="w-20 h-20 mx-auto mb-2 rounded-full object-cover">
                <h3 class="font-bold text-pink-400">ãƒã‚¤ãƒ¡ãƒ­</h3>
            </div>
        </div>

        <!-- Menu Tabs -->
        <div class="flex justify-center mb-6">
            <button id="crepeTab" class="bg-pink-500 text-white px-6 py-2 rounded-l-lg font-bold">ã‚¯ãƒ¬ãƒ¼ãƒ— ğŸ¥</button>
            <button id="pancakeTab" class="bg-gray-300 text-gray-700 px-6 py-2 rounded-r-lg font-bold">ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­ ğŸ¥</button>
        </div>

        <!-- Crepe Menu -->
        <div id="crepeMenu" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
            <div class="menu-item bg-white rounded-lg p-6 shadow-lg" data-item="ãƒãƒ§ã‚³ãƒãƒŠãƒŠã‚¯ãƒ¬ãƒ¼ãƒ—" data-price="580" data-type="crepe">
                <div class="text-4xl mb-2">ğŸ«ğŸŒ</div>
                <h3 class="font-bold text-lg mb-2 text-brown-600">ãƒãƒ§ã‚³ãƒãƒŠãƒŠã‚¯ãƒ¬ãƒ¼ãƒ—</h3>
                <p class="text-gray-600 mb-3">ç”˜ã„ãƒãƒ§ã‚³ã¨ãƒãƒŠãƒŠã®å®šç•ªã‚³ãƒ³ãƒ“</p>
                <div class="flex justify-between items-center">
                    <span class="text-xl font-bold text-green-600">Â¥580</span>
                    <button class="add-to-cart bg-pink-500 text-white px-4 py-2 rounded-lg hover:bg-pink-600">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            </div>
            <div class="menu-item bg-white rounded-lg p-6 shadow-lg" data-item="ã„ã¡ã”ãƒ›ã‚¤ãƒƒãƒ—ã‚¯ãƒ¬ãƒ¼ãƒ—" data-price="620" data-type="crepe">
                <div class="text-4xl mb-2">ğŸ“ğŸ¦</div>
                <h3 class="font-bold text-lg mb-2 text-red-500">ã„ã¡ã”ãƒ›ã‚¤ãƒƒãƒ—ã‚¯ãƒ¬ãƒ¼ãƒ—</h3>
                <p class="text-gray-600 mb-3">æ–°é®®ã„ã¡ã”ã¨ãµã‚ãµã‚ãƒ›ã‚¤ãƒƒãƒ—</p>
                <div class="flex justify-between items-center">
                    <span class="text-xl font-bold text-green-600">Â¥620</span>
                    <button class="add-to-cart bg-pink-500 text-white px-4 py-2 rounded-lg hover:bg-pink-600">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            </div>
            <div class="menu-item bg-white rounded-lg p-6 shadow-lg" data-item="æŠ¹èŒ¶ã‚ãšãã‚¯ãƒ¬ãƒ¼ãƒ—" data-price="650" data-type="crepe">
                <div class="text-4xl mb-2">ğŸƒğŸ«˜</div>
                <h3 class="font-bold text-lg mb-2 text-green-600">æŠ¹èŒ¶ã‚ãšãã‚¯ãƒ¬ãƒ¼ãƒ—</h3>
                <p class="text-gray-600 mb-3">å’Œé¢¨ãƒ†ã‚¤ã‚¹ãƒˆã®ä¸Šå“ãªå‘³ã‚ã„</p>
                <div class="flex justify-between items-center">
                    <span class="text-xl font-bold text-green-600">Â¥650</span>
                    <button class="add-to-cart bg-pink-500 text-white px-4 py-2 rounded-lg hover:bg-pink-600">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            </div>
            <div class="menu-item bg-white rounded-lg p-6 shadow-lg" data-item="ã‚«ã‚¹ã‚¿ãƒ¼ãƒ‰ã‚¯ãƒ¬ãƒ¼ãƒ—" data-price="550" data-type="crepe">
                <div class="text-4xl mb-2">ğŸ®</div>
                <h3 class="font-bold text-lg mb-2 text-yellow-600">ã‚«ã‚¹ã‚¿ãƒ¼ãƒ‰ã‚¯ãƒ¬ãƒ¼ãƒ—</h3>
                <p class="text-gray-600 mb-3">æ¿ƒåšã‚«ã‚¹ã‚¿ãƒ¼ãƒ‰ãŒãŸã£ã·ã‚Š</p>
                <div class="flex justify-between items-center">
                    <span class="text-xl font-bold text-green-600">Â¥550</span>
                    <button class="add-to-cart bg-pink-500 text-white px-4 py-2 rounded-lg hover:bg-pink-600">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Pancake Menu -->
        <div id="pancakeMenu" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8 hidden">
            <div class="menu-item bg-white rounded-lg p-6 shadow-lg" data-item="ãµã‚ãµã‚ãƒã‚¿ãƒ¼ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­" data-price="680" data-type="pancake">
                <div class="text-4xl mb-2">ğŸ¥ğŸ§ˆ</div>
                <h3 class="font-bold text-lg mb-2 text-yellow-500">ãµã‚ãµã‚ãƒã‚¿ãƒ¼ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­</h3>
                <p class="text-gray-600 mb-3">å®šç•ªã®ãƒã‚¿ãƒ¼&ãƒ¡ãƒ¼ãƒ—ãƒ«ã‚·ãƒ­ãƒƒãƒ—</p>
                <div class="flex justify-between items-center">
                    <span class="text-xl font-bold text-green-600">Â¥680</span>
                    <button class="add-to-cart bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            </div>
            <div class="menu-item bg-white rounded-lg p-6 shadow-lg" data-item="ãƒ•ãƒ«ãƒ¼ãƒ„ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­" data-price="780" data-type="pancake">
                <div class="text-4xl mb-2">ğŸ¥ğŸ“ğŸŒ</div>
                <h3 class="font-bold text-lg mb-2 text-red-500">ãƒ•ãƒ«ãƒ¼ãƒ„ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­</h3>
                <p class="text-gray-600 mb-3">å­£ç¯€ã®ãƒ•ãƒ«ãƒ¼ãƒ„ãŒãŸã£ã·ã‚Š</p>
                <div class="flex justify-between items-center">
                    <span class="text-xl font-bold text-green-600">Â¥780</span>
                    <button class="add-to-cart bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            </div>
            <div class="menu-item bg-white rounded-lg p-6 shadow-lg" data-item="ãƒãƒ§ã‚³ãƒãƒƒãƒ—ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­" data-price="720" data-type="pancake">
                <div class="text-4xl mb-2">ğŸ¥ğŸ«</div>
                <h3 class="font-bold text-lg mb-2 text-brown-600">ãƒãƒ§ã‚³ãƒãƒƒãƒ—ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­</h3>
                <p class="text-gray-600 mb-3">ãƒãƒ§ã‚³ãƒãƒƒãƒ—ãŒã‚¶ã‚¯ã‚¶ã‚¯</p>
                <div class="flex justify-between items-center">
                    <span class="text-xl font-bold text-green-600">Â¥720</span>
                    <button class="add-to-cart bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            </div>
            <div class="menu-item bg-white rounded-lg p-6 shadow-lg" data-item="ãƒ¡ãƒ¼ãƒ—ãƒ«ã‚·ãƒ­ãƒƒãƒ—ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­" data-price="650" data-type="pancake">
                <div class="text-4xl mb-2">ğŸ¥ğŸ¯</div>
                <h3 class="font-bold text-lg mb-2 text-amber-600">ãƒ¡ãƒ¼ãƒ—ãƒ«ã‚·ãƒ­ãƒƒãƒ—ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­</h3>
                <p class="text-gray-600 mb-3">æœ¬æ ¼ãƒ¡ãƒ¼ãƒ—ãƒ«ã‚·ãƒ­ãƒƒãƒ—ã‚’ãŸã£ã·ã‚Šã¨</p>
                <div class="flex justify-between items-center">
                    <span class="text-xl font-bold text-green-600">Â¥650</span>
                    <button class="add-to-cart bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Cart Modal -->
        <div id="cartModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold">ğŸ›’ ã‚«ãƒ¼ãƒˆ</h2>
                    <button id="closeCart" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <div id="cartItems" class="mb-4">
                    <!-- ã‚«ãƒ¼ãƒˆã‚¢ã‚¤ãƒ†ãƒ ãŒè¡¨ç¤ºã•ã‚Œã‚‹ -->
                </div>
                <div class="border-t pt-4">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-xl font-bold">åˆè¨ˆ:</span>
                        <span id="cartTotal" class="text-xl font-bold text-green-600">Â¥0</span>
                    </div>
                    <button id="orderBtn" class="w-full bg-green-500 text-white py-3 rounded-lg font-bold hover:bg-green-600">
                        æ³¨æ–‡ã™ã‚‹
                    </button>
                </div>
            </div>
        </div>

        <!-- Cooking Animation -->
        <div id="cookingAnimation" class="cooking-animation hidden">
            <div id="cookingStep" class="cooking-step">ğŸ³</div>
            <div id="cookingText" class="text-xl font-bold mb-4">èª¿ç†ä¸­...</div>
            <div class="text-sm text-gray-600">å°‘ã€…ãŠå¾…ã¡ãã ã•ã„â™ª</div>
        </div>
    </div>

    <script>
        let selectedCharacter = null;
        let cart = [];
        let recognition = null;
        let isListening = false;

        // Text-to-Speech function
        function speak(text, character = 'kitty') {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'ja-JP';
                utterance.rate = 0.9;
                utterance.pitch = character === 'kuromi' ? 0.8 : 1.2;
                speechSynthesis.speak(utterance);
            }
        }

        // Character selection
        document.querySelectorAll('.character-card').forEach(card => {
            card.addEventListener('click', () => {
                document.querySelectorAll('.character-card').forEach(c => c.classList.remove('character-active'));
                card.classList.add('character-active');
                selectedCharacter = card.dataset.character;
                
                const greetings = {
                    kitty: 'ã„ã‚‰ã£ã—ã‚ƒã„ã¾ã›â™ª ä»Šæ—¥ã¯ã©ã¡ã‚‰ã®ãƒ‡ã‚¶ãƒ¼ãƒˆã«ã„ãŸã—ã¾ã—ã‚‡ã†ï¼Ÿ',
                    kuromi: 'ã‚ãŸã—ã®ãŠã™ã™ã‚ã€é£Ÿã¹ã¦ã¿ãªã„ï¼Ÿ',
                    pochacco: 'ã‚ã‚“ã‚ã‚“ï¼ç¾å‘³ã—ã„ãƒ‡ã‚¶ãƒ¼ãƒˆãŒã„ã£ã±ã„ã ã‚ˆï¼',
                    cinnamoroll: 'ãµã‚ãµã‚ã€œâ™ª ç”˜ã„ãƒ‡ã‚¶ãƒ¼ãƒˆã¯ã„ã‹ãŒã§ã™ã‹ï¼Ÿ',
                    mymelody: 'ãŠå®¢æ§˜ã€œâ™ª ã©ã¡ã‚‰ã®ãƒ‡ã‚¶ãƒ¼ãƒˆãŒãŠæ°—ã«å…¥ã‚Šã§ã™ã‹ï¼Ÿ'
                };
                
                speak(greetings[selectedCharacter], selectedCharacter);
            });
        });

        // Menu tabs
        document.getElementById('crepeTab').addEventListener('click', () => {
            document.getElementById('crepeTab').classList.add('bg-pink-500', 'text-white');
            document.getElementById('crepeTab').classList.remove('bg-gray-300', 'text-gray-700');
            document.getElementById('pancakeTab').classList.add('bg-gray-300', 'text-gray-700');
            document.getElementById('pancakeTab').classList.remove('bg-blue-500', 'text-white');
            document.getElementById('crepeMenu').classList.remove('hidden');
            document.getElementById('pancakeMenu').classList.add('hidden');
        });

        document.getElementById('pancakeTab').addEventListener('click', () => {
            document.getElementById('pancakeTab').classList.add('bg-blue-500', 'text-white');
            document.getElementById('pancakeTab').classList.remove('bg-gray-300', 'text-gray-700');
            document.getElementById('crepeTab').classList.add('bg-gray-300', 'text-gray-700');
            document.getElementById('crepeTab').classList.remove('bg-pink-500', 'text-white');
            document.getElementById('pancakeMenu').classList.remove('hidden');
            document.getElementById('crepeMenu').classList.add('hidden');
        });

        // Add to cart
        document.addEventListener('click', (e) => {
            if (e.target.closest('.add-to-cart')) {
                const menuItem = e.target.closest('.menu-item');
                const item = {
                    name: menuItem.dataset.item,
                    price: parseInt(menuItem.dataset.price),
                    type: menuItem.dataset.type,
                    id: Date.now()
                };
                
                cart.push(item);
                updateCartUI();
                showCookingAnimation(item);
                
                if (selectedCharacter) {
                    const responses = {
                        kitty: `${item.name}ã§ã™ã­â™ª ã™ãã«ãŠä½œã‚Šã„ãŸã—ã¾ã™ï¼`,
                        kuromi: `${item.name}ã­ï¼ ã‚ãŸã—ãŒä½œã£ã¦ã‚ã’ã‚‹â™ª`,
                        pochacco: `${item.name}ã ã­ï¼ ç¾å‘³ã—ãä½œã‚‹ã‚ˆã€œï¼`,
                        cinnamoroll: `${item.name}ã§ã™ã­ã€œâ™ª ãµã‚ãµã‚ã«ä½œã‚Šã¾ã™ï¼`,
                        mymelody: `${item.name}ã§ã™ã­â™ª å¿ƒã‚’è¾¼ã‚ã¦ãŠä½œã‚Šã—ã¾ã™ã€œ`
                    };
                    speak(responses[selectedCharacter], selectedCharacter);
                }
            }
        });

        // Cooking animation
        function showCookingAnimation(item) {
            const animation = document.getElementById('cookingAnimation');
            const step = document.getElementById('cookingStep');
            const text = document.getElementById('cookingText');
            
            animation.classList.remove('hidden');
            
            if (item.type === 'crepe') {
                // Crepe animation
                const steps = [
                    { emoji: 'ğŸ³', text: 'ç”Ÿåœ°ã‚’ç„¼ã„ã¦ã„ã¾ã™...' },
                    { emoji: 'ğŸ“', text: 'ãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚’è¿½åŠ ä¸­...' },
                    { emoji: 'ğŸŒ€', text: 'ã‚¯ãƒ¬ãƒ¼ãƒ—ã‚’å·»ã„ã¦ã„ã¾ã™...' },
                    { emoji: 'âœ¨', text: 'å®Œæˆã§ã™â™ª' }
                ];
                
                let currentStep = 0;
                step.textContent = steps[currentStep].emoji;
                text.textContent = steps[currentStep].text;
                
                const interval = setInterval(() => {
                    currentStep++;
                    if (currentStep < steps.length) {
                        step.textContent = steps[currentStep].emoji;
                        text.textContent = steps[currentStep].text;
                    } else {
                        clearInterval(interval);
                        setTimeout(() => {
                            animation.classList.add('hidden');
                            showNotification(`${item.name}ãŒå®Œæˆã—ã¾ã—ãŸï¼`);
                        }, 1000);
                    }
                }, 1500);
            } else {
                // Pancake animation
                const steps = [
                    { emoji: 'ğŸ¥„', text: 'ç”Ÿåœ°ã‚’æ··ãœã¦ã„ã¾ã™...' },
                    { emoji: 'ğŸ³', text: 'ç„¼ã„ã¦ã„ã¾ã™...' },
                    { emoji: 'ğŸ¥', text: 'é‡ã­ã¦ã„ã¾ã™...' },
                    { emoji: 'ğŸ¯', text: 'ãƒˆãƒƒãƒ”ãƒ³ã‚°ä¸­...' },
                    { emoji: 'âœ¨', text: 'å®Œæˆã§ã™â™ª' }
                ];
                
                let currentStep = 0;
                step.textContent = steps[currentStep].emoji;
                text.textContent = steps[currentStep].text;
                
                const interval = setInterval(() => {
                    currentStep++;
                    if (currentStep < steps.length) {
                        step.textContent = steps[currentStep].emoji;
                        text.textContent = steps[currentStep].text;
                    } else {
                        clearInterval(interval);
                        setTimeout(() => {
                            animation.classList.add('hidden');
                            showNotification(`${item.name}ãŒå®Œæˆã—ã¾ã—ãŸï¼`);
                        }, 1000);
                    }
                }, 1200);
            }
        }

        // Show notification
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Update cart UI
        function updateCartUI() {
            document.getElementById('cartCount').textContent = cart.length;
            
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            
            cartItems.innerHTML = '';
            let total = 0;
            
            cart.forEach(item => {
                total += item.price;
                const itemElement = document.createElement('div');
                itemElement.className = 'flex justify-between items-center mb-2 p-2 bg-gray-100 rounded';
                itemElement.innerHTML = `
                    <span>${item.name}</span>
                    <div>
                        <span class="font-bold">Â¥${item.price}</span>
                        <button class="ml-2 text-red-500 hover:text-red-700" onclick="removeFromCart(${item.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                cartItems.appendChild(itemElement);
            });
            
            cartTotal.textContent = `Â¥${total}`;
        }

        // Remove from cart
        function removeFromCart(id) {
            cart = cart.filter(item => item.id !== id);
            updateCartUI();
        }

        // Cart modal
        document.getElementById('cartBtn').addEventListener('click', () => {
            document.getElementById('cartModal').classList.remove('hidden');
            document.getElementById('cartModal').classList.add('flex');
        });

        document.getElementById('closeCart').addEventListener('click', () => {
            document.getElementById('cartModal').classList.add('hidden');
            document.getElementById('cartModal').classList.remove('flex');
        });

        document.getElementById('orderBtn').addEventListener('click', () => {
            if (cart.length === 0) {
                alert('ã‚«ãƒ¼ãƒˆãŒç©ºã§ã™ï¼');
                return;
            }
            
            const total = cart.reduce((sum, item) => sum + item.price, 0);
            alert(`ã”æ³¨æ–‡ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼\nåˆè¨ˆ: Â¥${total}`);
            
            if (selectedCharacter) {
                const thankYou = {
                    kitty: 'ã”æ³¨æ–‡ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸâ™ª ã¾ãŸãŠè¶Šã—ãã ã•ã„ã¾ã›ï¼',
                    kuromi: 'ã‚ã‚ŠãŒã¨â™ª ã¾ãŸæ¥ã¦ã­ã€œï¼',
                    pochacco: 'ã‚ã‚“ã‚ã‚“ï¼ã‚ã‚ŠãŒã¨ã†ï¼ã¾ãŸæ¥ã¦ã­ï¼',
                    cinnamoroll: 'ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€œâ™ª ã¾ãŸãŠå¾…ã¡ã—ã¦ã„ã¾ã™ï¼',
                    mymelody: 'ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸâ™ª ã¾ãŸãŠä¼šã„ã—ã¾ã—ã‚‡ã†ã­ã€œ'
                };
                speak(thankYou[selectedCharacter], selectedCharacter);
            }
            
            cart = [];
            updateCartUI();
            document.getElementById('cartModal').classList.add('hidden');
            document.getElementById('cartModal').classList.remove('flex');
        });

        // Voice recognition
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.lang = 'ja-JP';
            recognition.continuous = false;
            recognition.interimResults = false;

            recognition.onstart = () => {
                isListening = true;
                document.getElementById('voiceBtn').classList.add('voice-active');
            };

            recognition.onend = () => {
                isListening = false;
                document.getElementById('voiceBtn').classList.remove('voice-active');
            };

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript.toLowerCase();
                console.log('èªè­˜çµæœ:', transcript);
                
                // Process voice order
                processVoiceOrder(transcript);
            };

            document.getElementById('voiceBtn').addEventListener('click', () => {
                if (isListening) {
                    recognition.stop();
                } else {
                    recognition.start();
                }
            });
        } else {
            document.getElementById('voiceBtn').style.display = 'none';
        }

        // Process voice order
        function processVoiceOrder(transcript) {
            const menuItems = [
                { name: 'ãƒãƒ§ã‚³ãƒãƒŠãƒŠã‚¯ãƒ¬ãƒ¼ãƒ—', price: 580, type: 'crepe', keywords: ['ãƒãƒ§ã‚³ãƒãƒŠãƒŠ', 'ãƒãƒ§ã‚³', 'ãƒãƒŠãƒŠ'] },
                { name: 'ã„ã¡ã”ãƒ›ã‚¤ãƒƒãƒ—ã‚¯ãƒ¬ãƒ¼ãƒ—', price: 620, type: 'crepe', keywords: ['ã„ã¡ã”', 'ãƒ›ã‚¤ãƒƒãƒ—', 'ã‚¤ãƒã‚´'] },
                { name: 'æŠ¹èŒ¶ã‚ãšãã‚¯ãƒ¬ãƒ¼ãƒ—', price: 650, type: 'crepe', keywords: ['æŠ¹èŒ¶', 'ã‚ãšã', 'ã‚¢ã‚ºã‚­'] },
                { name: 'ã‚«ã‚¹ã‚¿ãƒ¼ãƒ‰ã‚¯ãƒ¬ãƒ¼ãƒ—', price: 550, type: 'crepe', keywords: ['ã‚«ã‚¹ã‚¿ãƒ¼ãƒ‰'] },
                { name: 'ãµã‚ãµã‚ãƒã‚¿ãƒ¼ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­', price: 680, type: 'pancake', keywords: ['ãƒã‚¿ãƒ¼', 'ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­', 'ãµã‚ãµã‚'] },
                { name: 'ãƒ•ãƒ«ãƒ¼ãƒ„ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­', price: 780, type: 'pancake', keywords: ['ãƒ•ãƒ«ãƒ¼ãƒ„', 'ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­'] },
                { name: 'ãƒãƒ§ã‚³ãƒãƒƒãƒ—ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­', price: 720, type: 'pancake', keywords: ['ãƒãƒ§ã‚³ãƒãƒƒãƒ—', 'ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­'] },
                { name: 'ãƒ¡ãƒ¼ãƒ—ãƒ«ã‚·ãƒ­ãƒƒãƒ—ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­', price: 650, type: 'pancake', keywords: ['ãƒ¡ãƒ¼ãƒ—ãƒ«', 'ã‚·ãƒ­ãƒƒãƒ—', 'ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­'] }
            ];

            for (const item of menuItems) {
                for (const keyword of item.keywords) {
                    if (transcript.includes(keyword)) {
                        const cartItem = {
                            name: item.name,
                            price: item.price,
                            type: item.type,
                            id: Date.now()
                        };
                        
                        cart.push(cartItem);
                        updateCartUI();
                        showCookingAnimation(cartItem);
                        
                        if (selectedCharacter) {
                            const responses = {
                                kitty: `${item.name}ã§ã™ã­â™ª æ‰¿ã‚Šã¾ã—ãŸï¼`,
                                kuromi: `${item.name}ã­ï¼ äº†è§£ã‚ˆâ™ª`,
                                pochacco: `${item.name}ã ã­ï¼ ä½œã‚‹ã‚ˆã€œï¼`,
                                cinnamoroll: `${item.name}ã§ã™ã­ã€œâ™ª ãŠä½œã‚Šã—ã¾ã™ï¼`,
                                mymelody: `${item.name}ã§ã™ã­â™ª ã‹ã—ã“ã¾ã‚Šã¾ã—ãŸã€œ`
                            };
                            speak(responses[selectedCharacter], selectedCharacter);
                        }
                        return;
                    }
                }
            }
            
            // If no item matched
            if (selectedCharacter) {
                speak('ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ã€‚ã‚‚ã†ä¸€åº¦ãŠã£ã—ã‚ƒã£ã¦ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ', selectedCharacter);
            }
        }

        // Initialize
        document.querySelector('.character-card').click();
    </script>
</body>
</html>
